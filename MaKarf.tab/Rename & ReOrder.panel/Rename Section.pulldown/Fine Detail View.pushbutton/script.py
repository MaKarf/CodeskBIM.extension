# -*- coding: utf-8 -*-
"""
=====================================================================================================================
╦╔╦╗╔═╗╔═╗╦═╗╔╦╗╔═╗
║║║║╠═╝║ ║╠╦╝ ║ ╚═╗
╩╩ ╩╩  ╚═╝╩╚═ ╩ ╚═╝ IMPORTS
=====================================================================================================================
"""
import operator
from Autodesk.Revit.DB import BuiltInCategory as Bic
from Autodesk.Revit.DB import FilteredElementCollector as Fec
from Autodesk.Revit.DB import Transaction
from Autodesk.Revit.DB import ViewType

"""
=====================================================================================================================
╦  ╦╔═╗╦═╗╦╔═╗╔╗ ╦  ╔═╗╔═╗
╚╗╔╝╠═╣╠╦╝║╠═╣╠╩╗║  ║╣ ╚═╗
 ╚╝ ╩ ╩╩╚═╩╩ ╩╚═╝╩═╝╚═╝╚═╝ VARIABLES
=====================================================================================================================
"""

ui_doc = __revit__.ActiveUIDocument
doc = __revit__.ActiveUIDocument.Document
t = Transaction(doc, "Revit Transaction")

"""
=====================================================================================================================
╔═╗╦ ╦╔╗╔╔═╗╔╦╗╦╔═╗╔╗╔╔═╗
╠╣ ║ ║║║║║   ║ ║║ ║║║║╚═╗
╚  ╚═╝╝╚╝╚═╝ ╩ ╩╚═╝╝╚╝╚═╝ FUNCTIONS
=====================================================================================================================
"""

"""##############################################################################################################"""
"""####################################    A P P L I C A T I O N      ###########################################"""
"""##############################################################################################################"""

views_collection = Fec(doc).OfCategory(Bic.OST_Views).WhereElementIsNotElementType().ToElements()


def view_detail_level():
    for view in views_collection:
        """ ignore view templates"""
        if not view.IsTemplate:
            # print(view.LookupParameter("Detail Level").AsValueString())
            """Course : 1, Medium: 2, Fine: 3"""
            try:
                view.LookupParameter("Detail Level").Set(3)
            except Exception:
                # print(view.Name)
                pass

    """##############################################################################################################"""
    """##############################################################################################################"""


def run():
    t.Start()
    view_detail_level()
    t.Commit()


run()
